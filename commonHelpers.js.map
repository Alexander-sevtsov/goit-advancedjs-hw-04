{"version":3,"file":"commonHelpers.js","sources":["../src/js/api.js","../src/js/service.js","../src/js/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '23308675-3bdf2416796cf281a4ef874ab';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function fetchImages(value, page = 1) {\n  const params = {\n    key: API_KEY,\n    q: value,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page,\n    per_page: 40,\n  };\n\n  const resp = await axios.get(`${BASE_URL}?key=${API_KEY}`, { params });\n  return resp.data;\n}\n","const elements = {\n  loader: document.querySelector('.loader'),\n  loadMoreBtn: document.querySelector('.load-more'),\n};\n\nexport function showLoader() {\n  elements.loader.classList.remove('hidden');\n}\n\nexport function hideLoader() {\n  elements.loader.classList.add('hidden');\n}\n\nexport function showLoadMoreBtn() {\n  elements.loadMoreBtn.classList.remove('hidden');\n}\n\nexport function hideLoadMoreBtn() {\n  elements.loadMoreBtn.classList.add('hidden');\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { fetchImages } from './api';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport {\n  hideLoader,\n  hideLoadMoreBtn,\n  showLoadMoreBtn,\n  showLoader,\n} from './service';\n\nconst elements = {\n  form: document.querySelector('.search-form'),\n  gallery: document.querySelector('.gallery'),\n  loadMoreBtn: document.querySelector('.load-more'),\n  guard: document.querySelector('.js-guard'),\n};\n\nlet limitPage;\nlet page = 1;\nlet galleryMode;\nconst objectsPerPage = 40;\n\nelements.form.addEventListener('submit', handleForm);\n\n// ---------infinity scroll -----------\n\nconst options = {\n  root: null,\n  rootMargin: '300px',\n  threshold: 1.0,\n};\nconst observer = new IntersectionObserver(handlerLoadMore, options);\n\n// -------------------------------\n\nfunction initGallery() {\n  galleryMode = new SimpleLightbox('.gallery__link', {\n    /* options */\n  });\n}\n\nasync function handleForm(evt) {\n  evt.preventDefault();\n  showLoader();\n  observer.unobserve(elements.guard);\n  page = 1;\n  elements.gallery.innerHTML = '';\n\n  const { searchQuery } = evt.currentTarget.elements;\n  const optimizeSearchQuery = searchQuery.value.trim().toLowerCase();\n  if (!optimizeSearchQuery) {\n    hideLoader();\n    return iziToast.show({\n      title: 'Warrning',\n      message: 'Write the requset value!',\n      color: 'yellow',\n      position: 'bottomRight',\n    });\n  }\n\n  try {\n    const data = await fetchImages(optimizeSearchQuery, page);\n\n    if (data.hits.length <= 0) {\n      iziToast.show({\n        title: 'Warrning',\n        message:\n          'Sorry, there are no images matching your search query. Please try again.',\n        color: 'yellow',\n        position: 'bottomRight',\n      });\n      return;\n    }\n\n    iziToast.show({\n      title: 'Success',\n      message: `Hooray! We found ${data.totalHits} images.`,\n      color: 'green',\n      position: 'bottomRight',\n    });\n\n    elements.gallery.innerHTML = createMarkUp(data.hits);\n    initGallery();\n    limitPage = Math.ceil(data.totalHits / objectsPerPage);\n\n    if (data.hits.length < data.totalHits) {\n      observer.observe(elements.guard);\n    }\n  } catch (error) {\n    iziToast.show({\n      title: 'Error',\n      message: `${error.message}`,\n      color: 'red',\n      position: 'topRight',\n    });\n  } finally {\n    hideLoader();\n  }\n}\n\nfunction createMarkUp(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        tags,\n        largeImageURL,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<div class=\"photo-card\">\n        <a class='gallery__link' href=${largeImageURL}>\n    <img src=${webformatURL} alt=${tags}  loading=\"lazy\" />\n    </a>\n    <div class=\"info\">\n        <p class=\"info-item\">\n            <b>Likes</b>\n            ${likes}\n        </p>\n            <p class=\"info-item\">\n        <b>Views</b>\n        ${views}\n        </p>\n        <p class=\"info-item\">\n            <b>Comments</b>\n            ${comments}\n        </p>\n        <p class=\"info-item\">\n            <b>Downloads</b>\n            ${downloads}\n        </p>\n    </div>\n    \n</div>`;\n      }\n    )\n    .join('');\n}\n\n// ---------infinity scroll -----------\n\nasync function handlerLoadMore(entries) {\n  entries.forEach(async entry => {\n    if (entry.isIntersecting) {\n      page += 1;\n      const optimizeSearchQuery = elements.form.searchQuery.value\n        .trim()\n        .toLowerCase();\n\n      if (page > limitPage) {\n        observer.unobserve(elements.guard);\n        return iziToast.show({\n          title: 'Warrning',\n          message: 'No more images to load.',\n          color: 'yellow',\n          position: 'bottomRight',\n        });\n      }\n\n      try {\n        const data = await fetchImages(optimizeSearchQuery, page);\n\n        elements.gallery.insertAdjacentHTML(\n          'beforeend',\n          createMarkUp(data.hits)\n        );\n        galleryMode.refresh();\n      } catch (error) {\n        iziToast.show({\n          title: 'Error',\n          message: `${error.message}`,\n          color: 'red',\n          position: 'bottomRight',\n        });\n      }\n    }\n  });\n}\n\n// --------LOAD MORE ----------\n\n// elements.loadMoreBtn.addEventListener('click', handleLoadMore);\n\n// async function handleLoadMore() {\n//   page += 1;\n//   const optimizeSearchQuery = elements.form.searchQuery.value\n//     .trim()\n//     .toLowerCase();\n\n//   try {\n//     const data = await fetchImages(optimizeSearchQuery, page);\n//     if (data.hits.length <= 0) {\n//       iziToast.show({\n//         title: 'Warrning',\n//         message: 'No more images to load.',\n//         color: 'yellow',\n//         position: 'topRight',\n//       });\n//       hideLoadMoreBtn();\n//     }\n//       elements.gallery.insertAdjacentHTML('beforeend', createMarkUp(data.hits));\n//       showLoadMoreBtn();\n//\n//   } catch (error) {\n//     iziToast.show({\n//       title: 'Error',\n//       message: `${error.message}`,\n//       color: 'red',\n//       position: 'topRight',\n//     });\n//   }\n// }\n"],"names":["API_KEY","BASE_URL","fetchImages","value","page","params","axios","elements","showLoader","hideLoader","limitPage","galleryMode","objectsPerPage","handleForm","options","observer","handlerLoadMore","initGallery","SimpleLightbox","evt","searchQuery","optimizeSearchQuery","iziToast","data","createMarkUp","error","arr","webformatURL","tags","largeImageURL","likes","views","comments","downloads","entries","entry"],"mappings":"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"}